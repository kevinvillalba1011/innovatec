<div class="team-dashboard-container" *ngIf="boss && teamStats">
    <div class="dashboard-header">
        <div class="header-content">
            <div class="welcome-section">
                <h1>Dashboard del Equipo</h1>
                <p class="boss-info">Jefe: {{ boss.name }} ({{ boss.code }})</p>
            </div>
            <button class="logout-btn" (click)="logout()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                    <polyline points="16 17 21 12 16 7"></polyline>
                    <line x1="21" y1="12" x2="9" y2="12"></line>
                </svg>
                Salir
            </button>
        </div>
    </div>

    <!-- Team Stats Grid -->
    <div class="stats-grid">
        <div class="stat-card team-size">
            <div class="stat-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="9" cy="7" r="4"></circle>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                </svg>
            </div>
            <div class="stat-content">
                <p class="stat-label">Asesores en el Equipo</p>
                <h2 class="stat-value">{{ teamStats.totalAdvisors }}</h2>
            </div>
        </div>

        <div class="stat-card total-collection">
            <div class="stat-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <line x1="12" y1="1" x2="12" y2="23"></line>
                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                </svg>
            </div>
            <div class="stat-content">
                <p class="stat-label">Recaudo Total del Equipo</p>
                <h2 class="stat-value">{{ formatCurrency(teamStats.totalCollection) }}</h2>
            </div>
        </div>

        <div class="stat-card total-goal">
            <div class="stat-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <circle cx="12" cy="12" r="6"></circle>
                    <circle cx="12" cy="12" r="2"></circle>
                </svg>
            </div>
            <div class="stat-content">
                <p class="stat-label">Meta Total del Equipo</p>
                <h2 class="stat-value">{{ formatCurrency(teamStats.totalGoal) }}</h2>
            </div>
        </div>

        <div class="stat-card team-progress">
            <div class="stat-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                </svg>
            </div>
            <div class="stat-content">
                <p class="stat-label">Progreso del Equipo</p>
                <h2 class="stat-value">{{ teamStats.progressPercentage.toFixed(1) }}%</h2>
            </div>
        </div>
    </div>

    <!-- Team Progress Bar -->
    <div class="progress-section">
        <div class="progress-header">
            <h3>Progreso General del Equipo</h3>
            <div class="percentage-badge" [style.background]="getProgressGradient(teamStats.progressPercentage)">
                {{ teamStats.progressPercentage.toFixed(1) }}%
            </div>
        </div>

        <div class="progress-bar-container">
            <div class="progress-bar-background">
                <div class="progress-bar-fill" [style.width.%]="teamStats.progressPercentage"
                    [style.background]="getProgressGradient(teamStats.progressPercentage)">
                    <div class="progress-shine"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Advisors Table -->
    <div class="advisors-section">
        <div class="section-header">
            <h3>Asesores del Equipo</h3>
            <p class="section-subtitle">{{ teamStats.totalAdvisors }} asesor(es) en total</p>
        </div>

        <div class="table-container">
            <table class="advisors-table">
                <thead>
                    <tr>
                        <th (click)="setSortBy('name')" class="sortable">
                            Nombre
                            <span class="sort-icon" *ngIf="sortBy === 'name'">
                                {{ sortDirection === 'asc' ? '↑' : '↓' }}
                            </span>
                        </th>
                        <th (click)="setSortBy('collection')" class="sortable">
                            Recaudo Actual
                            <span class="sort-icon" *ngIf="sortBy === 'collection'">
                                {{ sortDirection === 'asc' ? '↑' : '↓' }}
                            </span>
                        </th>
                        <th (click)="setSortBy('goal')" class="sortable">
                            Meta
                            <span class="sort-icon" *ngIf="sortBy === 'goal'">
                                {{ sortDirection === 'asc' ? '↑' : '↓' }}
                            </span>
                        </th>
                        <th (click)="setSortBy('progress')" class="sortable">
                            Progreso
                            <span class="sort-icon" *ngIf="sortBy === 'progress'">
                                {{ sortDirection === 'asc' ? '↑' : '↓' }}
                            </span>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let advisor of sortedAdvisors" class="advisor-row">
                        <td class="advisor-name">
                            <div class="name-cell">
                                <div class="avatar">{{ advisor.name.charAt(0).toUpperCase() }}</div>
                                <div class="name-info">
                                    <span class="name">{{ advisor.name }}</span>
                                    <span class="code">{{ advisor.code }}</span>
                                </div>
                            </div>
                        </td>
                        <td class="collection-amount">
                            {{ formatCurrency(advisor.currentCollection) }}
                        </td>
                        <td class="goal-amount">
                            {{ formatCurrency(advisor.collectionGoal) }}
                        </td>
                        <td class="progress-cell">
                            <div class="progress-wrapper">
                                <div class="mini-progress-bar">
                                    <div class="mini-progress-fill" [style.width.%]="getProgressPercentage(advisor)"
                                        [style.background]="getProgressGradient(getProgressPercentage(advisor))">
                                    </div>
                                </div>
                                <span class="progress-text"
                                    [style.color]="getProgressColor(getProgressPercentage(advisor))">
                                    {{ getProgressPercentage(advisor).toFixed(1) }}%
                                </span>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>